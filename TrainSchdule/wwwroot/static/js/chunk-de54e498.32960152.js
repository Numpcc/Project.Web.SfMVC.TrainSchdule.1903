(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-de54e498"],{2598:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"application-list ma-4"},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{lg:4,md:4,sm:24}},[n("el-card",{staticClass:"elevation-0",attrs:{shadow:"hover"}},[n("el-form",{ref:"queryForm",attrs:{model:e.queryForm}},[n("el-row",[n("el-col",{staticClass:"mb-3",attrs:{md:24,sm:12}},[n("div",{staticClass:"py-2 body-2 layout align-center row justify-space-between"},[e._v("\n                单位\n                "),n("el-button",{attrs:{circle:"",icon:"el-icon-refresh",size:"mini",type:"primary"},on:{click:e.getOnMyManage}})],1),e._v(" "),n("el-select",{staticClass:"full-width",attrs:{placeholder:"选择管辖单位"},on:{change:e.companyChanged},model:{value:e.queryForm.companyCode,callback:function(t){e.$set(e.queryForm,"companyCode",t)},expression:"queryForm.companyCode"}},[n("el-option",{attrs:{label:"--全部--",value:""}}),e._v(" "),e._l(e.myManages,function(e){return n("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})],2)],1),e._v(" "),n("el-col",{staticClass:"mb-3",attrs:{md:24,sm:12}},[n("div",{staticClass:"py-2 body-2 layout align-center row justify-space-between"},[e._v("\n                指定人员\n                "),n("el-switch",{model:{value:e.queryForm.isSearchUser,callback:function(t){e.$set(e.queryForm,"isSearchUser",t)},expression:"queryForm.isSearchUser"}})],1),e._v(" "),n("el-select",{directives:[{name:"show",rawName:"v-show",value:e.queryForm.isSearchUser,expression:"queryForm.isSearchUser"}],staticClass:"full-width",attrs:{placeholder:""},model:{value:e.queryForm.userId,callback:function(t){e.$set(e.queryForm,"userId",t)},expression:"queryForm.userId"}},e._l(e.membersOption,function(e){return n("el-option",{key:e.id,attrs:{label:e.realName,value:e.id}})}),1)],1),e._v(" "),n("el-col",{staticClass:"py-2",attrs:{span:24}},[n("el-button",{staticClass:"full-width",attrs:{type:"primary"},on:{click:e.searchData}},[e._v("查询")])],1)],1)],1)],1)],1),e._v(" "),n("el-col",{attrs:{lg:20,md:20,sm:24}},[n("ApplicationList",{attrs:{"data-list":e.dataList,"on-loading":e.onLoading},on:{refresh:e.searchData},scopedSlots:e._u([{key:"action",fn:function(t){var a=t.row,s=t.applyid;return[n("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.hendleExecute("保存",a,s)}}},[e._v("保存")]),e._v(" "),n("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(t){return e.hendleExecute("撤回",a,s)}}},[e._v("撤回")]),e._v(" "),n("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(t){return e.hendleExecute("发布",a,s)}}},[e._v("发布")]),e._v(" "),n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.hendleExecute("删除",a,s)}}},[e._v("删除")])]}}])},[n("template",{slot:"headeraction"},[n("el-button",{attrs:{icon:"el-icon-edit",type:"primary"},on:{click:e.handleCreate}},[e._v("添加")])],1)],2)],1)],1)],1)},s=[],i=n("bb28"),r=(n("7415"),n("48ba")),o=n("c9ee"),c=n("b8e7"),l=n("fcac"),u={name:"ApplyList",components:{ApplicationList:r["a"]},data:function(){return{queryForm:{companyCode:"",userId:"",isSearchUser:!1},dataList:[],onLoading:!1,myManages:[],membersOption:[],cacheMembers:[]}},created:function(){this.getOnMyManage()},methods:{getOnMyManage:function(){var e=this;Object(c["a"])().then(function(t){t.list&&(e.myManages=t.list||[])}).catch(function(e){console.warn(e)})},companyChanged:function(e){var t=this,n=this.cacheMembers.find(function(t){return t.companyCode===e});n?this.membersOption=n.list:Object(l["a"])({id:e}).then(function(n){n.list&&(t.membersOption=n.list,t.cacheMembers.push({companyCode:e,list:n.list}))})},hendleExecute:function(e,t,n){var a=this;if(!0===this.onLoading)return!1;var s={"保存":o["i"],"撤回":o["m"],"发布":o["h"],"删除":o["a"]},r=n,c=s[e];"删除"===e&&(r={id:n,Auth:{Code:201700816,AuthByUserID:"Root"}}),this.onLoading=!0,c(r).then(function(t){var s=t.status,r=a.dataList.find(function(e){return e.id===n});r&&(r.status=s,a.dataList=Object(i["a"])(a.dataList)),a.$message.success(e+"成功，请求状态已改变")}).catch(function(e){console.log(e),a.$message.error("操作失败")}).finally(function(){a.onLoading=!1})},handleCreate:function(){this.$router.push("/application/new")},searchData:function(){var e=this;if(!0===this.onLoading)return this.$message.warning("查询中，请等候");var t=this.queryForm,n=t.isSearchUser,a=t.userId,s=t.companyCode,i=o["c"],r={code:s};n&&(i=o["d"],r={id:a}),this.onLoading=!0,this.dataList=[],i(r).then(function(t){var n=t.list;e.dataList=n||[]}).finally(function(){return e.onLoading=!1})}}},d=u,m=(n("6e6d3"),n("17cc")),h=Object(m["a"])(d,a,s,!1,null,"be26c574",null);t["default"]=h.exports},"6e6d3":function(e,t,n){"use strict";var a=n("f124"),s=n.n(a);s.a},f124:function(e,t,n){}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-624dfb4b"],{"142e":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"application-new"},[a("el-card",{attrs:{"body-style":{padding:0},shadow:"hover"}},[a("div",{staticClass:"layout pa-3 row justify-space-between",style:{backgroundColor:e.theme}},[a("span",[e._v("新建申请")])]),e._v(" "),a("el-card",{staticClass:"elevation-0"},[a("div",{staticClass:"px-2 pb-2 pt-0"},[a("el-steps",{staticStyle:{"margin-top":"20px"},attrs:{active:e.active,"finish-status":"success",simple:""}},[a("el-step",{attrs:{title:"填写基础信息"}}),e._v(" "),a("el-step",{attrs:{title:"填写休假请求"}}),e._v(" "),a("el-step",{attrs:{title:"准备提交"}})],1)],1)]),e._v(" "),a("el-card",{staticClass:"elevation-0 p-relitive"},[a("div",{directives:[{name:"show",rawName:"v-show",value:1==e.showAll||0==e.active,expression:"showAll == true || active == 0"}],staticClass:"row layout"},[a("el-form",{ref:"form",staticClass:"full-width",attrs:{model:e.form,"label-width":"180px"}},[a("div",{staticClass:"subheading pa-3"},[e._v("一、填写基础信息")]),e._v(" "),a("el-form-item",{attrs:{label:"身份号"}},[a("el-input",{style:{width:"400px"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.fetchUserInfoes(t)}},model:{value:e.form.id,callback:function(t){e.$set(e.form,"id",t)},expression:"form.id"}},[a("el-tooltip",{staticClass:"item",attrs:{slot:"append",content:"点击自动查询对应信息",effect:"dark",placement:"bottom"},slot:"append"},[a("el-button",{attrs:{loading:e.OnloadingUserInfoes,icon:"el-icon-search"},on:{click:e.fetchUserInfoes}})],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"真实姓名"}},[a("el-input",{model:{value:e.form.realName,callback:function(t){e.$set(e.form,"realName",t)},expression:"form.realName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所在部门"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.companyName,callback:function(t){e.$set(e.form,"companyName",t)},expression:"form.companyName"}})],1),e._v(" "),a("el-form-item",{attrs:{hidden:"",label:"所在部门"}},[a("el-input",{attrs:{disabled:"",hidden:""},model:{value:e.form.company,callback:function(t){e.$set(e.form,"company",t)},expression:"form.company"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"担任职务"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.duties,callback:function(t){e.$set(e.form,"duties",t)},expression:"form.duties"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"家庭地址"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.HomeDetailAddress,callback:function(t){e.$set(e.form,"HomeDetailAddress",t)},expression:"form.HomeDetailAddress"}})],1),e._v(" "),a("el-form-item",{attrs:{hidden:"",label:"家庭地址"}},[a("el-input",{model:{value:e.form.HomeAddress,callback:function(t){e.$set(e.form,"HomeAddress",t)},expression:"form.HomeAddress"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号码"}},[a("el-input",{model:{value:e.form.Phone,callback:function(t){e.$set(e.form,"Phone",t)},expression:"form.Phone"}})],1),e._v(" "),a("hr",{staticClass:"divider"}),e._v(" "),a("el-form-item",{attrs:{label:"回执编号"}},[a("el-input",{style:{width:"400px"},attrs:{disabled:""},model:{value:e.formFinal.baseInfoId,callback:function(t){e.$set(e.formFinal,"baseInfoId",t)},expression:"formFinal.baseInfoId"}},[a("div",{attrs:{slot:"prepend"},slot:"prepend"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitBaseInfo}},[e._v("生成")])],1),e._v(" "),e.formFinal.baseInfoId?a("el-button",{staticClass:"success",attrs:{slot:"append",loading:e.onLoading,icon:"el-icon-success",type:"success"},slot:"append"}):a("el-button",{attrs:{slot:"append",loading:e.onLoading,icon:"el-icon-question"},slot:"append"})],1)],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0==e.showAll,expression:"showAll == false"}]},[a("el-button",{attrs:{disabled:!e.formFinal.baseInfoId},on:{click:function(t){e.active=1}}},[e._v("下一步")])],1)],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1==e.showAll||1==e.active,expression:"showAll == true || active == 1"}],staticClass:"row layout"},[a("el-form",{ref:"formApply",staticClass:"full-width",attrs:{model:e.formApply,"label-width":"180px"}},[a("div",{staticClass:"subheading pa-3"},[e._v("二、填写休假请求")]),e._v(" "),a("el-form-item",{attrs:{label:"申请理由"}},[a("el-input",{model:{value:e.formApply.reason,callback:function(t){e.$set(e.formApply,"reason",t)},expression:"formApply.reason"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"休假类型"}},[a("el-select",{attrs:{placeholder:"必填"},model:{value:e.formApply.VocationType,callback:function(t){e.$set(e.formApply,"VocationType",t)},expression:"formApply.VocationType"}},[a("el-option",{attrs:{label:"正休",value:"zhengxiu"}}),e._v(" "),a("el-option",{attrs:{label:"事假",value:"shijia"}}),e._v(" "),a("el-option",{attrs:{label:"病休",value:"bingxiu"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"离队时间"}},[a("el-col",{attrs:{span:6}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{placeholder:"选择日期",type:"date"},model:{value:e.formApply.StampLeave,callback:function(t){e.$set(e.formApply,"StampLeave",t)},expression:"formApply.StampLeave"}})],1),e._v(" "),a("el-col",{staticClass:"line text-lg-right pr-2",attrs:{span:2}},[e._v("休假天数")]),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-input-number",{attrs:{max:100,min:1,label:"休假时长（天）"},model:{value:e.formApply.VocationLength,callback:function(t){e.$set(e.formApply,"VocationLength",t)},expression:"formApply.VocationLength"}})],1),e._v(" "),a("el-col",{staticClass:"line text-lg-right pr-2",attrs:{span:2}},[e._v("路途天数")]),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-input-number",{attrs:{max:100,min:1,label:"路途时间"},model:{value:e.formApply.OnTripLength,callback:function(t){e.$set(e.formApply,"OnTripLength",t)},expression:"formApply.OnTripLength"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"休假目的地"}},[a("el-cascader",{attrs:{options:e.locationOptions,"show-all-levels":!1},on:{"active-item-change":e.handleItemChange},model:{value:e.formApply.vocationPlaceArr,callback:function(t){e.$set(e.formApply,"vocationPlaceArr",t)},expression:"formApply.vocationPlaceArr"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"回执编号"}},[a("el-input",{style:{width:"400px"},attrs:{disabled:""},model:{value:e.formFinal.RequestId,callback:function(t){e.$set(e.formFinal,"RequestId",t)},expression:"formFinal.RequestId"}},[a("div",{attrs:{slot:"prepend"},slot:"prepend"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitRequestInfo}},[e._v("生成")])],1),e._v(" "),e.formFinal.RequestId?a("el-button",{staticClass:"success",attrs:{slot:"append",loading:e.onLoading,icon:"el-icon-success",type:"success"},slot:"append"}):a("el-button",{attrs:{slot:"append",loading:e.onLoading,icon:"el-icon-question"},slot:"append"})],1)],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0==e.showAll,expression:"showAll == false"}]},[a("el-button",{on:{click:function(t){e.active=0}}},[e._v("上一步")]),e._v(" "),a("el-button",{attrs:{disabled:!e.formFinal.RequestId},on:{click:function(t){e.active=2}}},[e._v("下一步")])],1)],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1==e.showAll||2==e.active,expression:"showAll == true || active == 2"}],staticClass:"row layout"},[a("el-form",{ref:"formFinal",staticClass:"full-width",attrs:{model:e.formFinal,"label-width":"180px"}},[a("div",{staticClass:"subheading pa-3"},[e._v("最后一步、准备提交")]),e._v(" "),a("el-form-item",{attrs:{label:"基础信息回执编号"}},[a("el-input",{attrs:{value:e.formFinal.baseInfoId,disabled:""}})],1),e._v(" "),a("el-form-item",{attrs:{label:"休假请求回执"}},[a("el-input",{attrs:{value:e.formFinal.RequestId,disabled:""}})],1),e._v(" "),e.formFinal.RequestId&&e.formFinal.baseInfoId?a("el-form-item",[a("el-alert",{attrs:{"show-icon":"",title:"信息填写完备，可以准备提交",type:"info"}})],1):e._e(),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0==e.showAll,expression:"showAll == false"}]},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.active=3}}},[e._v("准备提交")]),e._v(" "),a("el-button",{on:{click:function(t){e.active=1}}},[e._v("上一步")])],1)],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1==e.showAll||3==e.active,expression:"showAll == true || active == 3"}],staticClass:"row layout"}),e._v(" "),e.showAll?a("div",{staticClass:"mask"}):e._e(),e._v(" "),e.showAll?a("div",{staticClass:"footer-nav",style:{backgroundColor:e.theme}},[e.isAfterSubmit?a("div",{staticClass:"row layout justify-center fill-height"},[a("el-button",{on:{click:e.createNew}},[e._v("新建申请")])],1):a("div",{staticClass:"row layout justify-center fill-height"},[a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.onLoading,expression:"onLoading"}],on:{click:e.submitApply}},[e._v("提交")]),e._v(" "),a("el-button",{on:{click:function(t){e.active=0}}},[e._v("重新填写")])],1)]):e._e()])],1)],1)},o=[];function s(e,t){if(null==e)return{};var a,n,o={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}function i(e,t){if(null==e)return{};var a,n,o=s(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}a("3a23");var r=a("b8e7"),l=a("c9ee"),c=a("b775");function u(e){return Object(c["a"])({url:"/static/locationChildren",method:"get",params:{code:e}})}var d={name:"NewApply",data:function(){return{active:0,OnloadingUserInfoes:!1,onLoading:!1,form:{id:"",realName:"",company:"",companyName:"",duties:"",HomeAddress:0,HomeDetailAddress:"",Phone:"",Settle:0},formApply:{StampLeave:"",VocationLength:0,OnTripLength:0,VocationType:"",vocationPlace:0,vocationPlaceArr:[],reason:""},formFinal:{baseInfoId:"",RequestId:""},locationOptions:[{label:"选择休假地",value:0,children:[]},{label:"不选择",value:-1}],isAfterSubmit:!1}},computed:{showAll:function(){return 3===this.active},theme:function(){return this.$store.state.settings.theme}},methods:{getLocationChildrenIndexByValue:function(e,t){for(var a=0;a<e.children.length;a++)if(e.children[a].value===t)return a;return 0},handleItemChange:function(e){var t=this;if(e){var a=e.length-1,n=e[a];this.formApply.vocationPlaceArr=e,u(n).then(function(n){for(var o=n.list.map(function(e){return{label:e.name,value:e.code,children:[]}}),s=t.locationOptions[0],i=0,r=0;r<a;r++)i=t.getLocationChildrenIndexByValue(s,e[r+1]),s=s.children[i];s.children=o,0===s.children.length&&(s.children[0]={label:"无下一层级",disabled:!0})})}else this.$message.error("错误")},fetchUserInfoes:function(){var e=this,t=this.form.id;if(this.formFinal.RequestId="",this.formFinal.baseInfoId="",!0===this.OnloadingUserInfoes)return this.$message.info({message:"用户信息获取中，请稍等"});7===t.length||18===t.length?(this.OnloadingUserInfoes=!0,Object(r["b"])(this.form.id).then(function(t){e.OnloadingUserInfoes=!1;var a=t.base,n=t.company,o=t.duties,s=t.social;try{e.form.realName=a.realName,e.form.company=n.company.code,e.form.companyName=n.company.name,e.form.duties=o.name,e.form.HomeDetailAddress=s.addressDetail,e.form.HomeAddress=s.address.code,e.form.Phone=s.phone}catch(i){console.warn(i)}return e.$message.success("获取成功，已自动填充到表单")}).catch(function(){return e.OnloadingUserInfoes=!1,e.$message.warning("查询时错误")})):this.$message.warning({message:"非正确身份号码,正确格式为7位身份号或者18位法定身份证号码"})},submitBaseInfo:function(){var e=this,t=this.form,a=t.id,n=t.realName,o=t.company,s=t.duties,i=t.HomeAddress,r=t.HomeDetailAddress,c=t.Phone,u=t.Settle;this.onLoading=!0,Object(l["f"])({id:a,realName:n,company:o,duties:s,HomeAddress:i,HomeDetailAddress:r,Phone:c,Settle:u}).then(function(t){e.onLoading=!1,t.id&&(e.formFinal.baseInfoId=t.id,e.$message.success("成功提交，回执编号为："+t.id))}).catch(function(){e.onLoading=!1,e.formFinal.baseInfoId="",e.$message.error("基础信息提交失败，请检查填写信息")})},submitRequestInfo:function(){var e=this;if(!0===this.onLoading)return this.$message.info("生成中，请等待");var t=this.formApply,a=t.vocationPlaceArr,n=i(t,["vocationPlaceArr"]);a&&a.length>0&&(n.vocationPlace=a[a.length-1]);var o=Object.assign({},n,{id:this.form.id});this.onLoading=!0,Object(l["g"])(o).then(function(t){var a=t.id;if(e.formFinal.RequestId=a,a)return e.$message.success("申请信息提交完成，回执编号为"+a)}).catch(function(){return e.$message.error("提交失败，请重新检查表单")}).finally(function(){e.onLoading=!1})},submitApply:function(){var e=this;if(!0===this.onLoading)return this.$message.info("提交中，请等待");var t=this.formFinal.baseInfoId,a=this.formFinal.RequestId;this.onLoading=!0,Object(l["j"])({RequestId:a,BaseId:t,Verify:{Code:201700816}}).then(function(t){return e.active=3,e.isAfterSubmit=!0,e.$message.success("保存成功")}).catch(function(){return e.$message.error("保存失败")}).finally(function(){return e.onLoading=!1})},createNew:function(){this.active=0,this.form={id:"",realName:"",company:"",companyName:"",duties:"",HomeAddress:0,HomeDetailAddress:"",Phone:0,Settle:0},this.formApply={StampLeave:"2019-5-7",VocationLength:0,OnTripLength:0,VocationType:"",vocationPlace:0,vocationPlaceArr:[],reason:""},this.formFinal={baseInfoId:"",RequestId:""},this.onLoading=!1,this.isAfterSubmit=!1},handleChange:function(){}}},m=d,f=(a("fceb"),a("17cc")),p=Object(f["a"])(m,n,o,!1,null,"43e50ba5",null);t["default"]=p.exports},"32b0":function(e,t,a){},b8e7:function(e,t,a){"use strict";a.d(t,"a",function(){return i}),a.d(t,"b",function(){return r});var n=a("0c4b"),o=(a("612f"),a("b5ad"),a("b775")),s=a("c20c");function i(){return o["a"].get("users/onMyManage")}function r(e){return new Promise(function(t,a){Promise.all([Object(s["a"])(e),Object(s["b"])(e),Object(s["c"])(e),Object(s["d"])(e)]).then(function(e){var a=Object(n["a"])(e,4),o=a[0],s=a[1],i=a[2],r=a[3],l={base:o,company:s,duties:i,social:r};t(l)}).catch(a)})}},c20c:function(e,t,a){"use strict";a.d(t,"a",function(){return o}),a.d(t,"d",function(){return s}),a.d(t,"c",function(){return i}),a.d(t,"b",function(){return r});var n=a("b775");function o(e){return n["a"].get("users/base",{params:{id:e}})}function s(e){return n["a"].get("users/social",{params:{id:e}})}function i(e){return n["a"].get("users/duties",{params:{id:e}})}function r(e){return n["a"].get("users/company",{params:{id:e}})}},c9ee:function(e,t,a){"use strict";a.d(t,"d",function(){return o}),a.d(t,"f",function(){return s}),a.d(t,"g",function(){return i}),a.d(t,"j",function(){return r}),a.d(t,"a",function(){return l}),a.d(t,"i",function(){return c}),a.d(t,"h",function(){return u}),a.d(t,"m",function(){return d}),a.d(t,"l",function(){return m}),a.d(t,"c",function(){return f}),a.d(t,"e",function(){return p}),a.d(t,"k",function(){return v}),a.d(t,"b",function(){return h});var n=a("b775");function o(e){var t=e.id;return n["a"].get("/apply/fromUser",{params:{id:t}})}function s(e){return n["a"].post("/apply/BaseInfo",e)}function i(e){return n["a"].post("/apply/RequestInfo",e)}function r(e){return n["a"].post("/apply/Submit",e)}function l(e){return console.log(e),Object(n["a"])({url:"/apply/Submit",method:"delete",data:e})}function c(e){return n["a"].put("/apply/Save?id="+e)}function u(e){return n["a"].put("/apply/Publish?id="+e)}function d(e){return n["a"].put("/apply/Withdrew?id="+e)}function m(e){return n["a"].get("/apply/toUser",{params:e})}function f(e){var t=e.code;return n["a"].get("/apply/fromCompany",{params:{code:t}})}function p(){return n["a"].get("/apply/allStatus")}function v(e){var t=e.code;return Object(n["a"])({url:"/apply/toCompany",method:"get",params:{code:t}})}function h(e){return Object(n["a"])("/apply/detail",{params:{id:e}})}},fceb:function(e,t,a){"use strict";var n=a("32b0"),o=a.n(n);o.a}}]);